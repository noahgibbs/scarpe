<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Scarpe::WebviewWidget
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Scarpe::WebviewWidget";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (W)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Scarpe.html" title="Scarpe (class)">Scarpe</a></span></span>
     &raquo; 
    <span class="title">WebviewWidget</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="docpages_list_link"
        href="../docpages_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Scarpe::WebviewWidget
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../Shoes/Linkable.html" title="Shoes::Linkable (class)">Shoes::Linkable</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../Shoes/Linkable.html" title="Shoes::Linkable (class)">Shoes::Linkable</a></span></li>
          
            <li class="next">Scarpe::WebviewWidget</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="../Shoes/Log.html" title="Shoes::Log (module)">Shoes::Log</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/scarpe/wv/widget.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>The WebviewWidget parent class helps connect a Webview widget with
its Shoes equivalent, render itself to the Webview DOM, handle
Javascript events and generally keep things working in Webview.</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="WebviewAlert.html" title="Scarpe::WebviewAlert (class)">WebviewAlert</a></span>, <span class='object_link'><a href="WebviewApp.html" title="Scarpe::WebviewApp (class)">WebviewApp</a></span>, <span class='object_link'><a href="WebviewArc.html" title="Scarpe::WebviewArc (class)">WebviewArc</a></span>, <span class='object_link'><a href="WebviewButton.html" title="Scarpe::WebviewButton (class)">WebviewButton</a></span>, <span class='object_link'><a href="WebviewCheck.html" title="Scarpe::WebviewCheck (class)">WebviewCheck</a></span>, <span class='object_link'><a href="WebviewEditBox.html" title="Scarpe::WebviewEditBox (class)">WebviewEditBox</a></span>, <span class='object_link'><a href="WebviewEditLine.html" title="Scarpe::WebviewEditLine (class)">WebviewEditLine</a></span>, <span class='object_link'><a href="WebviewFont.html" title="Scarpe::WebviewFont (class)">WebviewFont</a></span>, <span class='object_link'><a href="WebviewImage.html" title="Scarpe::WebviewImage (class)">WebviewImage</a></span>, <span class='object_link'><a href="WebviewLine.html" title="Scarpe::WebviewLine (class)">WebviewLine</a></span>, <span class='object_link'><a href="WebviewLink.html" title="Scarpe::WebviewLink (class)">WebviewLink</a></span>, <span class='object_link'><a href="WebviewListBox.html" title="Scarpe::WebviewListBox (class)">WebviewListBox</a></span>, <span class='object_link'><a href="WebviewPara.html" title="Scarpe::WebviewPara (class)">WebviewPara</a></span>, <span class='object_link'><a href="WebviewRadio.html" title="Scarpe::WebviewRadio (class)">WebviewRadio</a></span>, <span class='object_link'><a href="WebviewShape.html" title="Scarpe::WebviewShape (class)">WebviewShape</a></span>, <span class='object_link'><a href="WebviewSlot.html" title="Scarpe::WebviewSlot (class)">WebviewSlot</a></span>, <span class='object_link'><a href="WebviewSpan.html" title="Scarpe::WebviewSpan (class)">WebviewSpan</a></span>, <span class='object_link'><a href="WebviewStar.html" title="Scarpe::WebviewStar (class)">WebviewStar</a></span>, <span class='object_link'><a href="WebviewSubscriptionItem.html" title="Scarpe::WebviewSubscriptionItem (class)">WebviewSubscriptionItem</a></span>, <span class='object_link'><a href="WebviewTextWidget.html" title="Scarpe::WebviewTextWidget (class)">WebviewTextWidget</a></span>, <span class='object_link'><a href="WebviewVideo.html" title="Scarpe::WebviewVideo (class)">WebviewVideo</a></span></p>
</div>



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../Shoes/Log.html" title="Shoes::Log (module)">Shoes::Log</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Shoes/Log.html#DEFAULT_COMPONENT-constant" title="Shoes::Log::DEFAULT_COMPONENT (constant)">Shoes::Log::DEFAULT_COMPONENT</a></span>, <span class='object_link'><a href="../Shoes/Log.html#DEFAULT_DEBUG_LOG_CONFIG-constant" title="Shoes::Log::DEFAULT_DEBUG_LOG_CONFIG (constant)">Shoes::Log::DEFAULT_DEBUG_LOG_CONFIG</a></span>, <span class='object_link'><a href="../Shoes/Log.html#DEFAULT_LOG_CONFIG-constant" title="Shoes::Log::DEFAULT_LOG_CONFIG (constant)">Shoes::Log::DEFAULT_LOG_CONFIG</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#children-instance_method" title="#children (instance method)">#<strong>children</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>An array of WebviewWidget children (possibly empty) of this widget.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#parent-instance_method" title="#parent (instance method)">#<strong>parent</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The WebviewWidget parent of this widget.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#shoes_linkable_id-instance_method" title="#shoes_linkable_id (instance method)">#<strong>shoes_linkable_id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The Shoes ID corresponding to the Shoes widget for this Webview widget.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="../Shoes/Linkable.html" title="Shoes::Linkable (class)">Shoes::Linkable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Shoes/Linkable.html#linkable_id-instance_method" title="Shoes::Linkable#linkable_id (method)">#linkable_id</a></span></p>


  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#display_class_for-class_method" title="display_class_for (class method)">.<strong>display_class_for</strong>(scarpe_class_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Return the corresponding Webview class for a particular Shoes class name.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#add_child-instance_method" title="#add_child (instance method)">#<strong>add_child</strong>(child)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Do not call directly, use set_parent.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#bind-instance_method" title="#bind (instance method)">#<strong>bind</strong>(event) { ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This binds a Scarpe JS callback, handled via a single dispatch point in the app.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy_self-instance_method" title="#destroy_self (instance method)">#<strong>destroy_self</strong>  &#x21d2; Scarpe::Promise </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Removes the element from both the Ruby Widget tree and the HTML DOM.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#handler_js_code-instance_method" title="#handler_js_code (instance method)">#<strong>handler_js_code</strong>(handler_function_name, *args)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Generate JS code to trigger a specific event name on this widget with the supplies arguments.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#html_element-instance_method" title="#html_element (instance method)">#<strong>html_element</strong>  &#x21d2; Scarpe::WebWrangler::ElementWrangler </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This gets a mini-webview for just this element and its children, if any.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#html_id-instance_method" title="#html_id (instance method)">#<strong>html_id</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Get the object&#39;s HTML ID.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(properties)  &#x21d2; WebviewWidget </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Set instance variables for the display properties of this widget.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A shorter inspect text for prettier irb output.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#needs_update!-instance_method" title="#needs_update! (instance method)">#<strong>needs_update!</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Request a full redraw of all widgets.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#promise_update-instance_method" title="#promise_update (instance method)">#<strong>promise_update</strong>  &#x21d2; Scarpe::Promise </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Return a promise that guarantees all currently-requested changes have completed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#properties_changed-instance_method" title="#properties_changed (instance method)">#<strong>properties_changed</strong>(changes)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Properties_changed will be called automatically when properties change.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#remove_child-instance_method" title="#remove_child (instance method)">#<strong>remove_child</strong>(child)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Do not call directly, use set_parent.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#rgb_to_hex-instance_method" title="#rgb_to_hex (instance method)">#<strong>rgb_to_hex</strong>(color)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Convert an [r, g, b, a] array to an HTML hex color code Arrays support alpha.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_parent-instance_method" title="#set_parent (instance method)">#<strong>set_parent</strong>(new_parent)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Give this widget a new parent, including managing the appropriate child lists for parent widgets.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#style-instance_method" title="#style (instance method)">#<strong>style</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>CSS styles.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_html-instance_method" title="#to_html (instance method)">#<strong>to_html</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>to_html is intended to get the HTML DOM rendering of this object and its children.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Shoes/Log.html" title="Shoes::Log (module)">Shoes::Log</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Shoes/Log.html#configure_logger-class_method" title="Shoes::Log.configure_logger (method)">configure_logger</a></span>, <span class='object_link'><a href="../Shoes/Log.html#log_init-instance_method" title="Shoes::Log#log_init (method)">#log_init</a></span>, <span class='object_link'><a href="../Shoes/Log.html#logger-class_method" title="Shoes::Log.logger (method)">logger</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../Shoes/Linkable.html" title="Shoes::Linkable (class)">Shoes::Linkable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Shoes/Linkable.html#bind_shoes_event-instance_method" title="Shoes::Linkable#bind_shoes_event (method)">#bind_shoes_event</a></span>, <span class='object_link'><a href="../Shoes/Linkable.html#send_self_event-instance_method" title="Shoes::Linkable#send_self_event (method)">#send_self_event</a></span>, <span class='object_link'><a href="../Shoes/Linkable.html#send_shoes_event-instance_method" title="Shoes::Linkable#send_shoes_event (method)">#send_shoes_event</a></span>, <span class='object_link'><a href="../Shoes/Linkable.html#unsub_shoes_event-instance_method" title="Shoes::Linkable#unsub_shoes_event (method)">#unsub_shoes_event</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(properties)  &#x21d2; <tt><span class='object_link'><a href="" title="Scarpe::WebviewWidget (class)">WebviewWidget</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Set instance variables for the display properties of this widget. Bind Shoes
events for changes of parent widget and changes of property values.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 39</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_properties'>properties</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_log_init'>log_init</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>WV::Widget</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='comment'># Call method, which looks up the parent
</span>  <span class='ivar'>@shoes_linkable_id</span> <span class='op'>=</span> <span class='id identifier rubyid_properties'>properties</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>shoes_linkable_id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_properties'>properties</span><span class='lbracket'>[</span><span class='symbol'>:shoes_linkable_id</span><span class='rbracket'>]</span>
  <span class='kw'>unless</span> <span class='ivar'>@shoes_linkable_id</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find property shoes_linkable_id in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># Set the display properties
</span>  <span class='id identifier rubyid_properties'>properties</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>shoes_linkable_id</span><span class='tstring_end'>&quot;</span></span>

    <span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_k'>k</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># The parent field is *almost* simple enough that a typed display property would handle it.
</span>  <span class='id identifier rubyid_bind_shoes_event'>bind_shoes_event</span><span class='lparen'>(</span><span class='label'>event_name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>parent</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>target:</span> <span class='id identifier rubyid_shoes_linkable_id'>shoes_linkable_id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_new_parent_id'>new_parent_id</span><span class='op'>|</span>
    <span class='id identifier rubyid_display_parent'>display_parent</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="WebviewDisplayService.html" title="Scarpe::WebviewDisplayService (class)">WebviewDisplayService</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="WebviewDisplayService.html#instance-class_method" title="Scarpe::WebviewDisplayService.instance (method)">instance</a></span></span><span class='period'>.</span><span class='id identifier rubyid_query_display_widget_for'>query_display_widget_for</span><span class='lparen'>(</span><span class='id identifier rubyid_new_parent_id'>new_parent_id</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='ivar'>@parent</span> <span class='op'>!=</span> <span class='id identifier rubyid_display_parent'>display_parent</span>
      <span class='id identifier rubyid_set_parent'>set_parent</span><span class='lparen'>(</span><span class='id identifier rubyid_display_parent'>display_parent</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># When Shoes widgets change properties, we get a change notification here
</span>  <span class='id identifier rubyid_bind_shoes_event'>bind_shoes_event</span><span class='lparen'>(</span><span class='label'>event_name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>prop_change</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>target:</span> <span class='id identifier rubyid_shoes_linkable_id'>shoes_linkable_id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_prop_changes'>prop_changes</span><span class='op'>|</span>
    <span class='id identifier rubyid_prop_changes'>prop_changes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_properties_changed'>properties_changed</span><span class='lparen'>(</span><span class='id identifier rubyid_prop_changes'>prop_changes</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_bind_shoes_event'>bind_shoes_event</span><span class='lparen'>(</span><span class='label'>event_name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>destroy</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>target:</span> <span class='id identifier rubyid_shoes_linkable_id'>shoes_linkable_id</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_destroy_self'>destroy_self</span>
  <span class='kw'>end</span>

  <span class='kw'>super</span><span class='lparen'>(</span><span class='label'>linkable_id:</span> <span class='ivar'>@shoes_linkable_id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="children-instance_method">
  
    #<strong>children</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>An array of WebviewWidget children (possibly empty) of this widget</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 35</span>

<span class='kw'>def</span> <span class='id identifier rubyid_children'>children</span>
  <span class='ivar'>@children</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="parent-instance_method">
  
    #<strong>parent</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The WebviewWidget parent of this widget</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parent'>parent</span>
  <span class='ivar'>@parent</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="shoes_linkable_id-instance_method">
  
    #<strong>shoes_linkable_id</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The Shoes ID corresponding to the Shoes widget for this Webview widget</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 29</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shoes_linkable_id'>shoes_linkable_id</span>
  <span class='ivar'>@shoes_linkable_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="display_class_for-class_method">
  
    .<strong>display_class_for</strong>(scarpe_class_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Return the corresponding Webview class for a particular Shoes class name</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 12</span>

<span class='kw'>def</span> <span class='id identifier rubyid_display_class_for'>display_class_for</span><span class='lparen'>(</span><span class='id identifier rubyid_scarpe_class_name'>scarpe_class_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scarpe_class'>scarpe_class</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Shoes.html" title="Shoes (module)">Shoes</a></span></span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='id identifier rubyid_scarpe_class_name'>scarpe_class_name</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_scarpe_class'>scarpe_class</span><span class='period'>.</span><span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Shoes.html" title="Shoes (module)">Shoes</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Shoes/Linkable.html" title="Shoes::Linkable (class)">Linkable</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Scarpe Webview can only get display classes for Shoes </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>linkable widgets, not </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scarpe_class_name'>scarpe_class_name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_klass'>klass</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Scarpe.html" title="Scarpe (class)">Scarpe</a></span></span><span class='period'>.</span><span class='id identifier rubyid_const_get'>const_get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Webview</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_scarpe_class_name'>scarpe_class_name</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>::</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_klass'>klass</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t find corresponding Scarpe Webview class for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scarpe_class_name'>scarpe_class_name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_klass'>klass</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_child-instance_method">
  
    #<strong>add_child</strong>(child)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Do not call directly, use set_parent</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 127</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_child'>add_child</span><span class='lparen'>(</span><span class='id identifier rubyid_child'>child</span><span class='rparen'>)</span>
  <span class='ivar'>@children</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@children</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_child'>child</span>

  <span class='comment'># If we add a child, we should redraw ourselves
</span>  <span class='id identifier rubyid_needs_update!'>needs_update!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="bind-instance_method">
  
    #<strong>bind</strong>(event) { ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This binds a Scarpe JS callback, handled via a single dispatch point in the app</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>event</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the Scarpe widget event name</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>the block to call when the event occurs</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bind'>bind</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Widget has no linkable_id! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_linkable_id'>linkable_id</span>

  <span class='const'><span class='object_link'><a href="WebviewDisplayService.html" title="Scarpe::WebviewDisplayService (class)">WebviewDisplayService</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="WebviewDisplayService.html#instance-class_method" title="Scarpe::WebviewDisplayService.instance (method)">instance</a></span></span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_linkable_id'>linkable_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event'>event</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="destroy_self-instance_method">
  
    #<strong>destroy_self</strong>  &#x21d2; <tt>Scarpe::Promise</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Removes the element from both the Ruby Widget tree and the HTML DOM.
Return a promise for when that HTML change will be visible.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Scarpe::Promise</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a promise that is fulfilled when the HTML change is complete</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_destroy_self'>destroy_self</span>
  <span class='ivar'>@parent</span><span class='op'>&amp;.</span><span class='id identifier rubyid_remove_child'>remove_child</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_html_element'>html_element</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handler_js_code-instance_method">
  
    #<strong>handler_js_code</strong>(handler_function_name, *args)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Generate JS code to trigger a specific event name on this widget with the supplies arguments.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>handler_function_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the event name - @see #bind</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>additional arguments that will be passed to the event in the generated JS</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the generated JS code</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245
246
247
248</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 243</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handler_js_code'>handler_js_code</span><span class='lparen'>(</span><span class='id identifier rubyid_handler_function_name'>handler_function_name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Widget has no linkable_id! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_linkable_id'>linkable_id</span>

  <span class='id identifier rubyid_js_args'>js_args</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_linkable_id'>linkable_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_handler_function_name'>handler_function_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>scarpeHandler(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_js_args'>js_args</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="html_element-instance_method">
  
    #<strong>html_element</strong>  &#x21d2; <tt><span class='object_link'><a href="WebWrangler/ElementWrangler.html" title="Scarpe::WebWrangler::ElementWrangler (class)">Scarpe::WebWrangler::ElementWrangler</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This gets a mini-webview for just this element and its children, if any.
It is normally called by the widget itself to do its DOM management.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="WebWrangler/ElementWrangler.html" title="Scarpe::WebWrangler::ElementWrangler (class)">Scarpe::WebWrangler::ElementWrangler</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a DOM object manager</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 176</span>

<span class='kw'>def</span> <span class='id identifier rubyid_html_element'>html_element</span>
  <span class='ivar'>@elt_wrangler</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../Scarpe.html" title="Scarpe (class)">Scarpe</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WebWrangler.html" title="Scarpe::WebWrangler (class)">WebWrangler</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="WebWrangler/ElementWrangler.html" title="Scarpe::WebWrangler::ElementWrangler (class)">ElementWrangler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="WebWrangler/ElementWrangler.html#initialize-instance_method" title="Scarpe::WebWrangler::ElementWrangler#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_html_id'>html_id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="html_id-instance_method">
  
    #<strong>html_id</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Get the object&#39;s HTML ID</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the HTML ID</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_html_id'>html_id</span>
  <span class='id identifier rubyid_object_id'>object_id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>A shorter inspect text for prettier irb output</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 110</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#&lt;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> @shoes_linkable_id=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@shoes_linkable_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> @parent=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@parent</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> @children=</span><span class='embexpr_beg'>#{</span><span class='ivar'>@children</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="needs_update!-instance_method">
  
    #<strong>needs_update!</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Request a full redraw of all widgets.</p>

<p>It&#39;s really hard to do dirty-tracking here because the redraws are fully asynchronous.
And so we can&#39;t easily cancel one &quot;in flight,&quot; and we can&#39;t easily pick up the latest
changes... And we probably don&#39;t want to, because we may be halfway through a batch.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


234
235
236</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 234</span>

<span class='kw'>def</span> <span class='id identifier rubyid_needs_update!'>needs_update!</span>
  <span class='const'><span class='object_link'><a href="WebviewDisplayService.html" title="Scarpe::WebviewDisplayService (class)">WebviewDisplayService</a></span></span><span class='period'>.</span><span class='id identifier rubyid_instance'><span class='object_link'><a href="WebviewDisplayService.html#instance-class_method" title="Scarpe::WebviewDisplayService.instance (method)">instance</a></span></span><span class='period'>.</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_request_redraw!'>request_redraw!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="promise_update-instance_method">
  
    #<strong>promise_update</strong>  &#x21d2; <tt>Scarpe::Promise</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Return a promise that guarantees all currently-requested changes have completed</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Scarpe::Promise</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a promise that will be fulfilled when all pending changes have finished</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_promise_update'>promise_update</span>
  <span class='id identifier rubyid_html_element'>html_element</span><span class='period'>.</span><span class='id identifier rubyid_promise_update'>promise_update</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="properties_changed-instance_method">
  
    #<strong>properties_changed</strong>(changes)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Properties_changed will be called automatically when properties change.
The widget should delete any changes from the Hash that it knows how
to incrementally handle, and pass the rest to super. If any changes
go entirely un-handled, a full redraw will be scheduled.
This exists to be overridden by children watching for changes.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>changes</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a Hash of new values for properties that have changed</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 85</span>

<span class='kw'>def</span> <span class='id identifier rubyid_properties_changed'>properties_changed</span><span class='lparen'>(</span><span class='id identifier rubyid_changes'>changes</span><span class='rparen'>)</span>
  <span class='comment'># If a widget does something really nonstandard with its html_id or element, it will
</span>  <span class='comment'># need to override to prevent this from happening. That&#39;s easy enough, though.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_changes'>changes</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hidden</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_hidden'>hidden</span> <span class='op'>=</span> <span class='id identifier rubyid_changes'>changes</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hidden</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_hidden'>hidden</span>
      <span class='id identifier rubyid_html_element'>html_element</span><span class='period'>.</span><span class='id identifier rubyid_set_style'>set_style</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>display</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>none</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_new_style'>new_style</span> <span class='op'>=</span> <span class='id identifier rubyid_style'>style</span> <span class='comment'># Get current display CSS property, which may vary by subclass
</span>      <span class='id identifier rubyid_disp'>disp</span> <span class='op'>=</span> <span class='id identifier rubyid_new_style'>new_style</span><span class='lbracket'>[</span><span class='symbol'>:display</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_html_element'>html_element</span><span class='period'>.</span><span class='id identifier rubyid_set_style'>set_style</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>display</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_disp'>disp</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>block</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_needs_update!'>needs_update!</span> <span class='kw'>unless</span> <span class='id identifier rubyid_changes'>changes</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_child-instance_method">
  
    #<strong>remove_child</strong>(child)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Do not call directly, use set_parent</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 117</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_child'>remove_child</span><span class='lparen'>(</span><span class='id identifier rubyid_child'>child</span><span class='rparen'>)</span>
  <span class='ivar'>@children</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>unless</span> <span class='ivar'>@children</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_child'>child</span><span class='rparen'>)</span>
    <span class='ivar'>@log</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>remove_child: no such child(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_child'>child</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>) for</span><span class='tstring_end'>&quot;</span></span>\
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> parent(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>)!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@children</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_child'>child</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rgb_to_hex-instance_method">
  
    #<strong>rgb_to_hex</strong>(color)  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Convert an [r, g, b, a] array to an HTML hex color code
Arrays support alpha. HTML hex does not. So premultiply.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 137</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rgb_to_hex'>rgb_to_hex</span><span class='lparen'>(</span><span class='id identifier rubyid_color'>color</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_color'>color</span> <span class='kw'>if</span> <span class='id identifier rubyid_color'>color</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='id identifier rubyid_r'>r</span><span class='comma'>,</span> <span class='id identifier rubyid_g'>g</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='op'>*</span><span class='id identifier rubyid_color'>color</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Float</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_a'>a</span> <span class='op'>||=</span> <span class='float'>1.0</span>
    <span class='id identifier rubyid_r_float'>r_float</span> <span class='op'>=</span> <span class='id identifier rubyid_r'>r</span> <span class='op'>*</span> <span class='id identifier rubyid_a'>a</span>
    <span class='id identifier rubyid_g_float'>g_float</span> <span class='op'>=</span> <span class='id identifier rubyid_g'>g</span> <span class='op'>*</span> <span class='id identifier rubyid_a'>a</span>
    <span class='id identifier rubyid_b_float'>b_float</span> <span class='op'>=</span> <span class='id identifier rubyid_b'>b</span> <span class='op'>*</span> <span class='id identifier rubyid_a'>a</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_a'>a</span> <span class='op'>||=</span> <span class='int'>255</span>
    <span class='id identifier rubyid_a_float'>a_float</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span> <span class='op'>/</span> <span class='float'>255.0</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_r_float'>r_float</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='float'>255.0</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_a_float'>a_float</span>
    <span class='id identifier rubyid_g_float'>g_float</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_g'>g</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='float'>255.0</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_a_float'>a_float</span>
    <span class='id identifier rubyid_b_float'>b_float</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span> <span class='op'>/</span> <span class='float'>255.0</span><span class='rparen'>)</span> <span class='op'>*</span> <span class='id identifier rubyid_a_float'>a_float</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_r_int'>r_int</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_r_float'>r_float</span> <span class='op'>*</span> <span class='float'>255.0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_clamp'>clamp</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>255</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_g_int'>g_int</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_g_float'>g_float</span> <span class='op'>*</span> <span class='float'>255.0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_clamp'>clamp</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>255</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_b_int'>b_int</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_b_float'>b_float</span> <span class='op'>*</span> <span class='float'>255.0</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='period'>.</span><span class='id identifier rubyid_clamp'>clamp</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>255</span><span class='rparen'>)</span>

  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#%0.2X%0.2X%0.2X</span><span class='tstring_end'>&quot;</span></span> <span class='op'>%</span> <span class='lbracket'>[</span><span class='id identifier rubyid_r_int'>r_int</span><span class='comma'>,</span> <span class='id identifier rubyid_g_int'>g_int</span><span class='comma'>,</span> <span class='id identifier rubyid_b_int'>b_int</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_parent-instance_method">
  
    #<strong>set_parent</strong>(new_parent)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Give this widget a new parent, including managing the appropriate child lists for parent widgets.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_parent'>set_parent</span><span class='lparen'>(</span><span class='id identifier rubyid_new_parent'>new_parent</span><span class='rparen'>)</span>
  <span class='ivar'>@parent</span><span class='op'>&amp;.</span><span class='id identifier rubyid_remove_child'>remove_child</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_new_parent'>new_parent</span><span class='op'>&amp;.</span><span class='id identifier rubyid_add_child'>add_child</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@parent</span> <span class='op'>=</span> <span class='id identifier rubyid_new_parent'>new_parent</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="style-instance_method">
  
    #<strong>style</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>CSS styles</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 162</span>

<span class='kw'>def</span> <span class='id identifier rubyid_style'>style</span>
  <span class='id identifier rubyid_styles'>styles</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='ivar'>@hidden</span>
    <span class='id identifier rubyid_styles'>styles</span><span class='lbracket'>[</span><span class='symbol'>:display</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>none</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_styles'>styles</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_html-instance_method">
  
    #<strong>to_html</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>to_html is intended to get the HTML DOM rendering of this object and its children.
Calling it should be side-effect-free and NOT update the webview.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the rendered HTML</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/widget.rb', line 198</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_html'>to_html</span>
  <span class='ivar'>@children</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_child_markup'>child_markup</span> <span class='op'>=</span> <span class='ivar'>@children</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_html</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:element</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_element'>element</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_child_markup'>child_markup</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_child_markup'>child_markup</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Aug 18 12:01:25 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.2.0).
</div>

    </div>
  </body>
</html>