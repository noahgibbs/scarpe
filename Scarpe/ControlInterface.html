<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Scarpe::ControlInterface
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Scarpe::ControlInterface";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Scarpe.html" title="Scarpe (class)">Scarpe</a></span></span>
     &raquo; 
    <span class="title">ControlInterface</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="docpages_list_link"
        href="../docpages_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Scarpe::ControlInterface
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Scarpe::ControlInterface</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Test/EventedAssertions.html" title="Scarpe::Test::EventedAssertions (module)">Test::EventedAssertions</a></span>, Test::Helpers, <span class='object_link'><a href="../Shoes/Log.html" title="Shoes::Log (module)">Shoes::Log</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/scarpe/wv/control_interface.rb<span class="defines">,<br />
  lib/scarpe/wv/control_interface_test.rb</span>
</dd>
  </dl>
  
</div>


  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="SUBSCRIBE_EVENTS-constant" class="">SUBSCRIBE_EVENTS =
          
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='symbol'>:init</span><span class='comma'>,</span> <span class='symbol'>:shutdown</span><span class='comma'>,</span> <span class='symbol'>:next_redraw</span><span class='comma'>,</span> <span class='symbol'>:every_redraw</span><span class='comma'>,</span> <span class='symbol'>:next_heartbeat</span><span class='comma'>,</span> <span class='symbol'>:every_heartbeat</span><span class='rbracket'>]</span></pre></dd>
      
        <dt id="DISPATCH_EVENTS-constant" class="">DISPATCH_EVENTS =
          
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='symbol'>:init</span><span class='comma'>,</span> <span class='symbol'>:shutdown</span><span class='comma'>,</span> <span class='symbol'>:redraw</span><span class='comma'>,</span> <span class='symbol'>:heartbeat</span><span class='rbracket'>]</span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../Shoes/Log.html" title="Shoes::Log (module)">Shoes::Log</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Shoes/Log.html#DEFAULT_COMPONENT-constant" title="Shoes::Log::DEFAULT_COMPONENT (constant)">Shoes::Log::DEFAULT_COMPONENT</a></span>, <span class='object_link'><a href="../Shoes/Log.html#DEFAULT_DEBUG_LOG_CONFIG-constant" title="Shoes::Log::DEFAULT_DEBUG_LOG_CONFIG (constant)">Shoes::Log::DEFAULT_DEBUG_LOG_CONFIG</a></span>, <span class='object_link'><a href="../Shoes/Log.html#DEFAULT_LOG_CONFIG-constant" title="Shoes::Log::DEFAULT_LOG_CONFIG (constant)">Shoes::Log::DEFAULT_LOG_CONFIG</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#do_shutdown-instance_method" title="#do_shutdown (instance method)">#<strong>do_shutdown</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the value of attribute do_shutdown.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#doc_root-instance_method" title="#doc_root (instance method)">#<strong>doc_root</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_wv_widgets-instance_method" title="#all_wv_widgets (instance method)">#<strong>all_wv_widgets</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Need to be able to query widgets in test code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#app-instance_method" title="#app (instance method)">#<strong>app</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert-instance_method" title="#assert (instance method)">#<strong>assert</strong>(value, msg = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_equal-instance_method" title="#assert_equal (instance method)">#<strong>assert_equal</strong>(val1, val2, msg = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_js-instance_method" title="#assert_js (instance method)">#<strong>assert_js</strong>(js_code, wait_for: [], timeout: DEFAULT_ASSERTION_TIMEOUT)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a promise to do a JS assertion, normally after other ops have finished.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assertion_data_as_a_struct-instance_method" title="#assertion_data_as_a_struct (instance method)">#<strong>assertion_data_as_a_struct</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assertions_may_exist-instance_method" title="#assertions_may_exist (instance method)">#<strong>assertions_may_exist</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assertions_pending%3F-instance_method" title="#assertions_pending? (instance method)">#<strong>assertions_pending?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#die_after-instance_method" title="#die_after (instance method)">#<strong>die_after</strong>(time)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dispatch_event-instance_method" title="#dispatch_event (instance method)">#<strong>dispatch_event</strong>(event, *args, **keywords)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Send out the specified event.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fail_assertion-instance_method" title="#fail_assertion (instance method)">#<strong>fail_assertion</strong>(id, fail_message)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_wv_widgets-instance_method" title="#find_wv_widgets (instance method)">#<strong>find_wv_widgets</strong>(*specifiers)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Shoes doesn&#39;t name widgets.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fully_updated-instance_method" title="#fully_updated (instance method)">#<strong>fully_updated</strong>(wait_for: [])  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; ControlInterface </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The control interface needs to see major system components to hook into their events.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_event-instance_method" title="#on_event (instance method)">#<strong>on_event</strong>(event, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>On recognised events, this sets a handler for that event.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pass_assertion-instance_method" title="#pass_assertion (instance method)">#<strong>pass_assertion</strong>(id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#return_when_assertions_done-instance_method" title="#return_when_assertions_done (instance method)">#<strong>return_when_assertions_done</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Note that we do <em>not</em> extract this assertions library to use elsewhere because it&#39;s very focused on evented assertions that start and stop over a period of time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_system_components-instance_method" title="#set_system_components (instance method)">#<strong>set_system_components</strong>(app:, doc_root:, wrangler:)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This should get called once, from Shoes::App.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_assertion-instance_method" title="#start_assertion (instance method)">#<strong>start_assertion</strong>(code)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_metadata-instance_method" title="#test_metadata (instance method)">#<strong>test_metadata</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This is returned alongside the actual results automatically.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timed_out%3F-instance_method" title="#timed_out? (instance method)">#<strong>timed_out?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_js_dom_html-instance_method" title="#with_js_dom_html (instance method)">#<strong>with_js_dom_html</strong>(wait_for: [], timeout: DEFAULT_ASSERTION_TIMEOUT, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#with_js_value-instance_method" title="#with_js_value (instance method)">#<strong>with_js_value</strong>(js_code, wait_for: [], timeout: DEFAULT_ASSERTION_TIMEOUT, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>How do we signal an error?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#wrangler-instance_method" title="#wrangler (instance method)">#<strong>wrangler</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Test/EventedAssertions.html" title="Scarpe::Test::EventedAssertions (module)">Test::EventedAssertions</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Test/EventedAssertions.html#assert_html-instance_method" title="Scarpe::Test::EventedAssertions#assert_html (method)">#assert_html</a></span>, <span class='object_link'><a href="Test/EventedAssertions.html#assert_include-instance_method" title="Scarpe::Test::EventedAssertions#assert_include (method)">#assert_include</a></span>, <span class='object_link'><a href="Test/EventedAssertions.html#assert_not_include-instance_method" title="Scarpe::Test::EventedAssertions#assert_not_include (method)">#assert_not_include</a></span>, <span class='object_link'><a href="Test/EventedAssertions.html#return_results-instance_method" title="Scarpe::Test::EventedAssertions#return_results (method)">#return_results</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Shoes/Log.html" title="Shoes::Log (module)">Shoes::Log</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Shoes/Log.html#configure_logger-class_method" title="Shoes::Log.configure_logger (method)">configure_logger</a></span>, <span class='object_link'><a href="../Shoes/Log.html#log_init-instance_method" title="Shoes::Log#log_init (method)">#log_init</a></span>, <span class='object_link'><a href="../Shoes/Log.html#logger-class_method" title="Shoes::Log.logger (method)">logger</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Scarpe::ControlInterface (class)">ControlInterface</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The control interface needs to see major system components to hook into their events</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26
27
28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='id identifier rubyid_log_init'>log_init</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>WV::ControlInterface</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='ivar'>@do_shutdown</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@event_handlers</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#SUBSCRIBE_EVENTS-constant" title="Scarpe::ControlInterface::SUBSCRIBE_EVENTS (constant)">SUBSCRIBE_EVENTS</a></span></span> <span class='op'>|</span> <span class='const'><span class='object_link'><a href="#DISPATCH_EVENTS-constant" title="Scarpe::ControlInterface::DISPATCH_EVENTS (constant)">DISPATCH_EVENTS</a></span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='ivar'>@event_handlers</span><span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="do_shutdown-instance_method">
  
    #<strong>do_shutdown</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the value of attribute do_shutdown.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 21</span>

<span class='kw'>def</span> <span class='id identifier rubyid_do_shutdown'>do_shutdown</span>
  <span class='ivar'>@do_shutdown</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="doc_root=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="doc_root-instance_method">
  
    #<strong>doc_root</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63
64
65
66
67
68</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 61</span>

<span class='kw'>def</span> <span class='id identifier rubyid_doc_root'>doc_root</span>
  <span class='kw'>unless</span> <span class='ivar'>@doc_root</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ControlInterface code needs to be wrapped in handlers like on_event(:init) </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>to make sure they have access to app, doc_root, wrangler, etc!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@doc_root</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="all_wv_widgets-instance_method">
  
    #<strong>all_wv_widgets</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Need to be able to query widgets in test code</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_wv_widgets'>all_wv_widgets</span>
  <span class='id identifier rubyid_known'>known</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_doc_root'>doc_root</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_to_check'>to_check</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_doc_root'>doc_root</span><span class='rbracket'>]</span>

  <span class='kw'>until</span> <span class='id identifier rubyid_to_check'>to_check</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_next_layer'>next_layer</span> <span class='op'>=</span> <span class='id identifier rubyid_to_check'>to_check</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:children</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_known'>known</span> <span class='op'>+=</span> <span class='id identifier rubyid_next_layer'>next_layer</span>
    <span class='id identifier rubyid_to_check'>to_check</span> <span class='op'>=</span> <span class='id identifier rubyid_next_layer'>next_layer</span>
  <span class='kw'>end</span>

  <span class='comment'># I don&#39;t *think* we&#39;ll ever have widget trees that merge back together, but just in case we&#39;ll de-dup
</span>  <span class='id identifier rubyid_known'>known</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="app-instance_method">
  
    #<strong>app</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54
55
56
57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 52</span>

<span class='kw'>def</span> <span class='id identifier rubyid_app'>app</span>
  <span class='kw'>unless</span> <span class='ivar'>@app</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ControlInterface code needs to be wrapped in handlers like on_event(:init) </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>to make sure they have access to app, doc_root, wrangler, etc!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@app</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert-instance_method">
  
    #<strong>assert</strong>(value, msg = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


173
174
175
176
177
178
179
180
181</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 173</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert'>assert</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_start_assertion'>start_assertion</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_caller'>caller</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_msg'>msg</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Value should be true!</span><span class='tstring_end'>&quot;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>
    <span class='id identifier rubyid_pass_assertion'>pass_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_fail_assertion'>fail_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Expected true Ruby value: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_equal-instance_method">
  
    #<strong>assert_equal</strong>(val1, val2, msg = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='id identifier rubyid_val1'>val1</span><span class='comma'>,</span> <span class='id identifier rubyid_val2'>val2</span><span class='comma'>,</span> <span class='id identifier rubyid_msg'>msg</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_val1'>val1</span> <span class='op'>==</span> <span class='id identifier rubyid_val2'>val2</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Expected </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val2'>val2</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> to equal </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_val1'>val1</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_js-instance_method">
  
    #<strong>assert_js</strong>(js_code, wait_for: [], timeout: DEFAULT_ASSERTION_TIMEOUT)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a promise to do a JS assertion, normally after other ops have finished.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 152</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_js'>assert_js</span><span class='lparen'>(</span><span class='id identifier rubyid_js_code'>js_code</span><span class='comma'>,</span> <span class='label'>wait_for:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../Scarpe.html#DEFAULT_ASSERTION_TIMEOUT-constant" title="Scarpe::DEFAULT_ASSERTION_TIMEOUT (constant)">DEFAULT_ASSERTION_TIMEOUT</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_start_assertion'>start_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_js_code'>js_code</span><span class='rparen'>)</span>

  <span class='comment'># this isn&#39;t a TestPromise, so it doesn&#39;t have the additional DSL entries
</span>  <span class='id identifier rubyid_promise'>promise</span> <span class='op'>=</span> <span class='id identifier rubyid_wrangler'>wrangler</span><span class='period'>.</span><span class='id identifier rubyid_eval_js_async'>eval_js_async</span><span class='lparen'>(</span><span class='id identifier rubyid_js_code'>js_code</span><span class='comma'>,</span> <span class='label'>wait_for:</span> <span class='id identifier rubyid_wait_for'>wait_for</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_promise'>promise</span><span class='period'>.</span><span class='id identifier rubyid_on_rejected'>on_rejected</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_fail_assertion'>fail_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>JS Eval failed: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_promise'>promise</span><span class='period'>.</span><span class='id identifier rubyid_reason'>reason</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_promise'>promise</span><span class='period'>.</span><span class='id identifier rubyid_on_fulfilled'>on_fulfilled</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_ret_val'>ret_val</span> <span class='op'>=</span> <span class='id identifier rubyid_promise'>promise</span><span class='period'>.</span><span class='id identifier rubyid_returned_value'>returned_value</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_ret_val'>ret_val</span>
      <span class='id identifier rubyid_pass_assertion'>pass_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_fail_assertion'>fail_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Expected true JS value: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ret_val'>ret_val</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># So we wrap it in a no-op TestPromise, to get the DSL entries.
</span>  <span class='const'><span class='object_link'><a href="TestPromise.html" title="Scarpe::TestPromise (class)">TestPromise</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="TestPromise.html#initialize-instance_method" title="Scarpe::TestPromise#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>iface:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>wait_for:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_promise'>promise</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_execute'>to_execute</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assertion_data_as_a_struct-instance_method">
  
    #<strong>assertion_data_as_a_struct</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assertion_data_as_a_struct'>assertion_data_as_a_struct</span>
  <span class='lbrace'>{</span>
    <span class='label'>still_pending:</span> <span class='ivar'>@assertions_pending</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span>
    <span class='label'>succeeded:</span> <span class='ivar'>@assertions_passed</span><span class='comma'>,</span>
    <span class='label'>failed:</span> <span class='ivar'>@assertions_failed</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span>
    <span class='label'>failures:</span> <span class='ivar'>@assertions_failed</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='symbol'>:code</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='symbol'>:failure_reason</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assertions_may_exist-instance_method">
  
    #<strong>assertions_may_exist</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assertions_may_exist'>assertions_may_exist</span>
  <span class='ivar'>@assertions_pending</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@assertions_failed</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@assertions_passed</span> <span class='op'>||=</span> <span class='int'>0</span>
  <span class='ivar'>@assertion_counter</span> <span class='op'>||=</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assertions_pending?-instance_method">
  
    #<strong>assertions_pending?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 138</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assertions_pending?'>assertions_pending?</span>
  <span class='op'>!</span><span class='ivar'>@assertions_pending</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="die_after-instance_method">
  
    #<strong>die_after</strong>(time)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_die_after'>die_after</span><span class='lparen'>(</span><span class='id identifier rubyid_time'>time</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_t_start'>t_start</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='ivar'>@die_after</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_t_start'>t_start</span><span class='comma'>,</span> <span class='id identifier rubyid_time'>time</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_wrangler'>wrangler</span><span class='period'>.</span><span class='id identifier rubyid_periodic_code'>periodic_code</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>scarpeTestTimeout</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid__args'>_args</span><span class='op'>|</span>
    <span class='id identifier rubyid_t_delta'>t_delta</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_t_start'>t_start</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_t_delta'>t_delta</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_time'>time</span>
      <span class='ivar'>@did_time_out</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='ivar'>@log</span><span class='period'>.</span><span class='id identifier rubyid_warn'>warn</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>die_after - timed out after </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_t_delta'>t_delta</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> (threshold: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_time'>time</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_return_results'>return_results</span><span class='lparen'>(</span><span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timed out!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dispatch_event-instance_method">
  
    #<strong>dispatch_event</strong>(event, *args, **keywords)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Send out the specified event</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dispatch_event'>dispatch_event</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_keywords'>keywords</span><span class='rparen'>)</span>
  <span class='ivar'>@log</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CTL event </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event'>event</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_keywords'>keywords</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#DISPATCH_EVENTS-constant" title="Scarpe::ControlInterface::DISPATCH_EVENTS (constant)">DISPATCH_EVENTS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Illegal dispatch of event </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event'>event</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>! Valid values are: </span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#DISPATCH_EVENTS-constant" title="Scarpe::ControlInterface::DISPATCH_EVENTS (constant)">DISPATCH_EVENTS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_inspect'><span class='object_link'><a href="#inspect-instance_method" title="Scarpe::ControlInterface#inspect (method)">inspect</a></span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='ivar'>@do_shutdown</span>
    <span class='ivar'>@log</span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CTL: Shutting down - not dispatching </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event'>event</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_event'>event</span> <span class='op'>==</span> <span class='symbol'>:redraw</span>
    <span class='id identifier rubyid_dumb_dispatch_event'>dumb_dispatch_event</span><span class='lparen'>(</span><span class='symbol'>:every_redraw</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_keywords'>keywords</span><span class='rparen'>)</span>

    <span class='comment'># Next redraw is interesting. We can add new handlers
</span>    <span class='comment'># when dispatching a next_redraw handler. But we want
</span>    <span class='comment'># each handler to run only once.
</span>    <span class='id identifier rubyid_handlers'>handlers</span> <span class='op'>=</span> <span class='ivar'>@event_handlers</span><span class='lbracket'>[</span><span class='symbol'>:next_redraw</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_dumb_dispatch_event'>dumb_dispatch_event</span><span class='lparen'>(</span><span class='symbol'>:next_redraw</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_keywords'>keywords</span><span class='rparen'>)</span>
    <span class='ivar'>@event_handlers</span><span class='lbracket'>[</span><span class='symbol'>:next_redraw</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='id identifier rubyid_handlers'>handlers</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_event'>event</span> <span class='op'>==</span> <span class='symbol'>:heartbeat</span>
    <span class='id identifier rubyid_dumb_dispatch_event'>dumb_dispatch_event</span><span class='lparen'>(</span><span class='symbol'>:every_heartbeat</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_keywords'>keywords</span><span class='rparen'>)</span>

    <span class='comment'># Next heartbeat is interesting. We can add new handlers
</span>    <span class='comment'># when dispatching a next_heartbeat handler. But we want
</span>    <span class='comment'># each handler to run only once.
</span>    <span class='id identifier rubyid_handlers'>handlers</span> <span class='op'>=</span> <span class='ivar'>@event_handlers</span><span class='lbracket'>[</span><span class='symbol'>:next_heartbeat</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_dumb_dispatch_event'>dumb_dispatch_event</span><span class='lparen'>(</span><span class='symbol'>:next_heartbeat</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_keywords'>keywords</span><span class='rparen'>)</span>
    <span class='ivar'>@event_handlers</span><span class='lbracket'>[</span><span class='symbol'>:next_heartbeat</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='id identifier rubyid_handlers'>handlers</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_event'>event</span> <span class='op'>==</span> <span class='symbol'>:shutdown</span>
    <span class='ivar'>@do_shutdown</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_dumb_dispatch_event'>dumb_dispatch_event</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_keywords'>keywords</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fail_assertion-instance_method">
  
    #<strong>fail_assertion</strong>(id, fail_message)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 132</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fail_assertion'>fail_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_fail_message'>fail_message</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_item'>item</span> <span class='op'>=</span> <span class='ivar'>@assertions_pending</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='symbol'>:fail_message</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_fail_message'>fail_message</span>
  <span class='ivar'>@assertions_failed</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_item'>item</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_wv_widgets-instance_method">
  
    #<strong>find_wv_widgets</strong>(*specifiers)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Shoes doesn&#39;t name widgets. We aren&#39;t guaranteed that the Shoes widgets are even in the same
process, since we have the Relay display service for Webview. So mostly we can look by
display service class.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75
76
77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_wv_widgets'>find_wv_widgets</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_specifiers'>specifiers</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_widgets'>widgets</span> <span class='op'>=</span> <span class='id identifier rubyid_all_wv_widgets'>all_wv_widgets</span>

  <span class='id identifier rubyid_specifiers'>specifiers</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_spec'>spec</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Class</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_widgets'>widgets</span><span class='period'>.</span><span class='id identifier rubyid_select!'>select!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_w'>w</span><span class='op'>|</span> <span class='id identifier rubyid_spec'>spec</span> <span class='op'>===</span> <span class='id identifier rubyid_w'>w</span> <span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I don&#39;t know how to search for widgets by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_spec'>spec</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_widgets'>widgets</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fully_updated-instance_method">
  
    #<strong>fully_updated</strong>(wait_for: [])  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


201
202
203</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 201</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fully_updated'>fully_updated</span><span class='lparen'>(</span><span class='label'>wait_for:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wrangler'>wrangler</span><span class='period'>.</span><span class='id identifier rubyid_promise_dom_fully_updated'>promise_dom_fully_updated</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;#ControlInterface&gt;</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_event-instance_method">
  
    #<strong>on_event</strong>(event, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>On recognised events, this sets a handler for that event</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 83</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_event'>on_event</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="#SUBSCRIBE_EVENTS-constant" title="Scarpe::ControlInterface::SUBSCRIBE_EVENTS (constant)">SUBSCRIBE_EVENTS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_event'>event</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Illegal subscribe to event </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event'>event</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'>! Valid values are: </span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="#SUBSCRIBE_EVENTS-constant" title="Scarpe::ControlInterface::SUBSCRIBE_EVENTS (constant)">SUBSCRIBE_EVENTS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_inspect'><span class='object_link'><a href="#inspect-instance_method" title="Scarpe::ControlInterface#inspect (method)">inspect</a></span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@unsub_id</span> <span class='op'>||=</span> <span class='int'>0</span>
  <span class='ivar'>@unsub_id</span> <span class='op'>+=</span> <span class='int'>1</span>

  <span class='ivar'>@event_handlers</span><span class='lbracket'>[</span><span class='id identifier rubyid_event'>event</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span> <span class='label'>handler:</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='label'>unsub:</span> <span class='ivar'>@unsub_id</span> <span class='rbrace'>}</span>
  <span class='ivar'>@unsub_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pass_assertion-instance_method">
  
    #<strong>pass_assertion</strong>(id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 127</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pass_assertion'>pass_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='ivar'>@assertions_pending</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='ivar'>@assertions_passed</span> <span class='op'>+=</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="return_when_assertions_done-instance_method">
  
    #<strong>return_when_assertions_done</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Note that we do <em>not</em> extract this assertions library to use elsewhere
because it&#39;s very focused on evented assertions that start and stop
over a period of time. Instantaneous procedural asserts don&#39;t want to
use this API.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96
97
98
99
100
101
102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_return_when_assertions_done'>return_when_assertions_done</span>
  <span class='id identifier rubyid_assertions_may_exist'>assertions_may_exist</span>

  <span class='id identifier rubyid_wrangler'>wrangler</span><span class='period'>.</span><span class='id identifier rubyid_periodic_code'>periodic_code</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>scarpeReturnWhenAssertionsDone</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid__args'>_args</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='ivar'>@assertions_pending</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_success'>success</span> <span class='op'>=</span> <span class='ivar'>@assertions_failed</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_return_results'>return_results</span> <span class='id identifier rubyid_success'>success</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Assertions </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_success'>success</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>succeeded</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>failed</span><span class='tstring_end'>&quot;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_assertion_data_as_a_struct'>assertion_data_as_a_struct</span>
      <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_system_components-instance_method">
  
    #<strong>set_system_components</strong>(app:, doc_root:, wrangler:)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This should get called once, from Shoes::App</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_system_components'>set_system_components</span><span class='lparen'>(</span><span class='label'>app:</span><span class='comma'>,</span> <span class='label'>doc_root:</span><span class='comma'>,</span> <span class='label'>wrangler:</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_app'>app</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_wrangler'>wrangler</span>
    <span class='ivar'>@log</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>False app passed to set_system_components!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_app'>app</span>
    <span class='ivar'>@log</span><span class='period'>.</span><span class='id identifier rubyid_error'>error</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>False wrangler passed to set_system_components!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_wrangler'>wrangler</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Must pass non-nil app and wrangler to ControlInterface#set_system_components!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='ivar'>@app</span> <span class='op'>=</span> <span class='id identifier rubyid_app'>app</span>
  <span class='ivar'>@doc_root</span> <span class='op'>=</span> <span class='id identifier rubyid_doc_root'>doc_root</span> <span class='comment'># May be nil at this point
</span>  <span class='ivar'>@wrangler</span> <span class='op'>=</span> <span class='id identifier rubyid_wrangler'>wrangler</span>

  <span class='ivar'>@wrangler</span><span class='period'>.</span><span class='id identifier rubyid_control_interface'>control_interface</span> <span class='op'>=</span> <span class='kw'>self</span>

  <span class='ivar'>@wrangler</span><span class='period'>.</span><span class='id identifier rubyid_on_every_redraw'>on_every_redraw</span> <span class='lbrace'>{</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dispatch_event'>dispatch_event</span><span class='lparen'>(</span><span class='symbol'>:redraw</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start_assertion-instance_method">
  
    #<strong>start_assertion</strong>(code)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115
116
117
118
119
120
121
122
123
124
125</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 113</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start_assertion'>start_assertion</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assertions_may_exist'>assertions_may_exist</span>

  <span class='id identifier rubyid_this_assertion'>this_assertion</span> <span class='op'>=</span> <span class='ivar'>@assertion_counter</span>
  <span class='ivar'>@assertion_counter</span> <span class='op'>+=</span> <span class='int'>1</span>

  <span class='ivar'>@assertions_pending</span><span class='lbracket'>[</span><span class='id identifier rubyid_this_assertion'>this_assertion</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>id:</span> <span class='id identifier rubyid_this_assertion'>this_assertion</span><span class='comma'>,</span>
    <span class='label'>code:</span> <span class='id identifier rubyid_code'>code</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_this_assertion'>this_assertion</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_metadata-instance_method">
  
    #<strong>test_metadata</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This is returned alongside the actual results automatically</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42
43
44
45
46
47
48
49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 40</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_metadata'>test_metadata</span>
  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='ivar'>@die_after</span>
    <span class='id identifier rubyid_t_delta'>t_delta</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='ivar'>@die_after</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
    <span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>die_after</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>t_start:</span> <span class='ivar'>@die_after</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
      <span class='label'>threshold:</span> <span class='ivar'>@die_after</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>passed:</span> <span class='id identifier rubyid_t_delta'>t_delta</span><span class='comma'>,</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_data'>data</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="timed_out?-instance_method">
  
    #<strong>timed_out?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_timed_out?'>timed_out?</span>
  <span class='ivar'>@did_time_out</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_js_dom_html-instance_method">
  
    #<strong>with_js_dom_html</strong>(wait_for: [], timeout: DEFAULT_ASSERTION_TIMEOUT, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_with_js_dom_html'>with_js_dom_html</span><span class='lparen'>(</span><span class='label'>wait_for:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../Scarpe.html#DEFAULT_ASSERTION_TIMEOUT-constant" title="Scarpe::DEFAULT_ASSERTION_TIMEOUT (constant)">DEFAULT_ASSERTION_TIMEOUT</a></span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_with_js_value'>with_js_value</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>document.getElementById(&#39;wrapper-wvroot&#39;).innerHTML</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>wait_for:</span> <span class='id identifier rubyid_wait_for'>wait_for</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="with_js_value-instance_method">
  
    #<strong>with_js_value</strong>(js_code, wait_for: [], timeout: DEFAULT_ASSERTION_TIMEOUT, &amp;block)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>How do we signal an error?</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


188
189
190
191
192
193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface_test.rb', line 188</span>

<span class='kw'>def</span> <span class='id identifier rubyid_with_js_value'>with_js_value</span><span class='lparen'>(</span><span class='id identifier rubyid_js_code'>js_code</span><span class='comma'>,</span> <span class='label'>wait_for:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../Scarpe.html#DEFAULT_ASSERTION_TIMEOUT-constant" title="Scarpe::DEFAULT_ASSERTION_TIMEOUT (constant)">DEFAULT_ASSERTION_TIMEOUT</a></span></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Must give a block to with_js_value!</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_block'>block</span>

  <span class='id identifier rubyid_js_promise'>js_promise</span> <span class='op'>=</span> <span class='id identifier rubyid_wrangler'>wrangler</span><span class='period'>.</span><span class='id identifier rubyid_eval_js_async'>eval_js_async</span><span class='lparen'>(</span><span class='id identifier rubyid_js_code'>js_code</span><span class='comma'>,</span> <span class='label'>wait_for:</span> <span class='id identifier rubyid_wait_for'>wait_for</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ruby_promise'>ruby_promise</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="TestPromise.html" title="Scarpe::TestPromise (class)">TestPromise</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="TestPromise.html#initialize-instance_method" title="Scarpe::TestPromise#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>iface:</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='label'>wait_for:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_js_promise'>js_promise</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ruby_promise'>ruby_promise</span><span class='period'>.</span><span class='id identifier rubyid_to_execute'>to_execute</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_ruby_promise'>ruby_promise</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="wrangler-instance_method">
  
    #<strong>wrangler</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/scarpe/wv/control_interface.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_wrangler'>wrangler</span>
  <span class='kw'>unless</span> <span class='ivar'>@wrangler</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ControlInterface code needs to be wrapped in handlers like on_event(:init) </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>to make sure they have access to app, doc_root, wrangler, etc!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@wrangler</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Aug 18 12:01:25 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.2.0).
</div>

    </div>
  </body>
</html>